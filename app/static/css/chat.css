:root{
  --bg: #0b1020;
  --panel: #111827;
  --muted: #6b7280;
  --text: #e5e7eb;
  --accent: #4f46e5;
  --bubble-user: #1f2937;
  --bubble-bot: #0e7490;
  --danger: #ef4444;
  --success: #22c55e;
}
@media (prefers-color-scheme: light){
  :root{
    --bg: #f3f4f6;
    --panel: #ffffff;
    --muted: #6b7280;
    --text: #111827;
    --accent: #4f46e5;
    --bubble-user: #e5e7eb;
    --bubble-bot: #e0f2fe;
  }
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font: 16px/1.4 "Inter", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  background: var(--bg);
  color: var(--text);
}
.chat-page{
  min-height:100dvh;
  display:grid;
  grid-template-rows:auto 1fr auto;
}
.chat-header{
  position:sticky; top:0; z-index:10;
  display:flex; justify-content:space-between; align-items:center;
  gap:.75rem; padding: .75rem 1rem;
  background: linear-gradient(180deg, rgba(17,24,39,.9), rgba(17,24,39,.6) 70%, rgba(17,24,39,0));
  backdrop-filter: blur(6px);
  border-bottom: 1px solid rgba(255,255,255,.06);
}
.chat-header .title{display:flex; gap:.6rem; align-items:center}
.chat-header .title .dot{
  width:.6rem; height:.6rem; border-radius:50%;
  background: var(--success); box-shadow: 0 0 .6rem var(--success);
}
.chat-header h1{font-size:1rem; margin:0; font-weight:600}
.chat-header .actions{display:flex; gap:.5rem}
.chat-header .actions button{
  appearance:none; border:none; padding:.45rem .7rem; border-radius:.6rem;
  background: var(--panel); color:var(--text); cursor:pointer;
  border:1px solid rgba(255,255,255,.06);
}
.chat-header .actions button:hover{filter:brightness(1.1)}

.messages{
  width:100%;
  max-width:900px;
  margin: 0 auto;
  padding: 1rem;
  display:flex; flex-direction:column; gap:.75rem;
}
.msg{
  display:flex; gap:.6rem; align-items:flex-end; width:100%;
}
.msg .avatar{
  width:28px; height:28px; border-radius:50%; flex: 0 0 auto;
  background: var(--panel); display:flex; align-items:center; justify-content:center;
  font-size:.75rem; color:var(--muted);
  border:1px solid rgba(255,255,255,.06)
}
.bubble{
  max-width: 80%;
  padding:.6rem .8rem; border-radius: .9rem;
  border:1px solid rgba(255,255,255,.06);
  white-space:pre-wrap; word-break:break-word;
}
.user .bubble{ background: var(--bubble-user); margin-left:auto; border-bottom-right-radius:.2rem }
.bot  .bubble{ background: var(--bubble-bot); margin-right:auto; border-bottom-left-radius:.2rem }

.meta{ font-size:.72rem; color:var(--muted); margin-top:.25rem }
.row{ display:flex; flex-direction:column; max-width:80% }
.user .row{ margin-left:auto }
.bot  .row{ margin-right:auto }

.composer{
  position:sticky; bottom:0; background: linear-gradient(0deg, var(--bg), transparent);
  padding: .75rem 1rem; border-top: 1px solid rgba(255,255,255,.06);
}
/* 3-column grid: ï¼‹ | textarea | send */
#composer-form{
  display:grid;
  grid-template-columns: auto 1fr auto;
  align-items:center;
  gap:.5rem;
  max-width:900px; margin:0 auto;
  background: var(--panel); padding:.5rem; border-radius:.8rem; border:1px solid rgba(255,255,255,.06)
}

/* middle column grows; avoid overflow in grid */
#chat-input{
  min-width:0;
  width:100%;
  background:transparent; border:none; color:var(--text); outline:none;
  padding:.6rem .5rem; font-size:1rem;
  resize: vertical; /* why: allow taller messages */
}

#send-btn{
  align-self:end;           /* why: anchor to textarea bottom */
  display:flex;
  align-items:flex-end;
  justify-content:flex-end;
  appearance:none;
  border:none; background:var(--accent); color:white; cursor:pointer;
  padding:.55rem .9rem; border-radius:.6rem; font-weight:600;
}

.hint{max-width:900px; margin:.5rem auto 0; color:var(--muted); font-size:.85rem}

.typing{ display:inline-flex; gap:.25rem; padding:.2rem .4rem; background:rgba(0,0,0,.15); border-radius:.5rem; }
.typing span{
  display:block; width:.35rem; height:.35rem; border-radius:50%; background: currentColor; opacity:.35;
  animation:b 1.2s infinite ease-in-out;
}
.typing span:nth-child(2){animation-delay:.15s}
.typing span:nth-child(3){animation-delay:.3s}
@keyframes b{0%,80%,100%{transform:scale(.6); opacity:.35} 40%{transform:scale(1); opacity:.9}}

.error{
  color:#fff; background: var(--danger); border-radius:.4rem; padding:.25rem .5rem; display:inline-block
}

code{ background: rgba(255,255,255,.07); padding:.1rem .25rem; border-radius:.3rem }